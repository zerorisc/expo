/* Copyright lowRISC contributors. */
/* Licensed under the Apache License, Version 2.0, see LICENSE for details. */
/* SPDX-License-Identifier: Apache-2.0 */
/* Modified by Authors of "Towards ML-KEM & ML-DSA on OpenTitan" (https://eprint.iacr.org/2024/1192) */
/* Copyright "Towards ML-KEM & ML-DSA on OpenTitan" Authors */


/**
 * Test for poly_add_dilithium
*/

.section .text.start

/* Entry point. */
.globl main
main:
  /* Init all-zero register. */
  bn.xor  w31, w31, w31

  /* MOD <= dmem[modulus] = DILITHIUM_Q */
  /*li      x2, 2
  la      x3, modulus
  bn.lid  x2, 0(x3)*/
  bn.addi w2, w31, 128
  bn.add w2, w31, w2 << 16
  bn.addi w3, w31, 32
  bn.sub w2, w2, w3 << 8
  bn.addi w30, w2, 1
  bn.wsrw 0x0, w30

  /* dmem[data] <= NTT(dmem[input]) */
  la  x12, output
  la  x10, input1
  la  x11, input2
  jal  x1, poly_add_dilithium

  ecall

.data
.balign 32
/* First input */
input1:
    .word 0xffcdbf12
    .word 0x002db175
    .word 0x003277b9
    .word 0x0026905b
    .word 0xffc60146
    .word 0x003a52d7
    .word 0x0034e13f
    .word 0x00251899
    .word 0xffcf5eae
    .word 0x002a751d
    .word 0x0027f7f9
    .word 0x003e7579
    .word 0x003fdbcb
    .word 0x00216501
    .word 0xffc48190
    .word 0xffccbaaa
    .word 0x002c2e1d
    .word 0xffd6f49a
    .word 0x0035914f
    .word 0xffd169a4
    .word 0x0035ea93
    .word 0xffcada28
    .word 0x0024395b
    .word 0xffc775e0
    .word 0x003f67ed
    .word 0xffc102c6
    .word 0x0033985f
    .word 0x00216295
    .word 0xffdfe6c8
    .word 0xffdbbe80
    .word 0xffc1eb50
    .word 0xffd656f8
    .word 0xffd4508a
    .word 0xffc349fa
    .word 0xffd5f8bc
    .word 0x00318943
    .word 0x002debf7
    .word 0xffddf392
    .word 0xffcd5366
    .word 0xffc50566
    .word 0xffdb069e
    .word 0x00272575
    .word 0x002d2e3b
    .word 0x0021267d
    .word 0x002fdc2d
    .word 0xffc5db16
    .word 0x00350571
    .word 0xffcef5b4
    .word 0xffc4aad0
    .word 0xffdb3dc2
    .word 0x00321ecb
    .word 0x002bf13d
    .word 0x003335e3
    .word 0x00239501
    .word 0xffc73700
    .word 0x00230f65
    .word 0xffdab526
    .word 0xffc63160
    .word 0xffc1b47e
    .word 0xffd22af8
    .word 0xffd2c7da
    .word 0xffd82d04
    .word 0xffd73da2
    .word 0xffcc4778
    .word 0xffda520e
    .word 0xffdc3534
    .word 0x002e8d61
    .word 0x00253f2b
    .word 0xffcb45a6
    .word 0xffc5c1ea
    .word 0x0038d95f
    .word 0xffd0aac0
    .word 0x002b174d
    .word 0xffd21eda
    .word 0x00202107
    .word 0xffc93a9a
    .word 0x002a94ef
    .word 0x002a30b7
    .word 0xffdd7942
    .word 0x002e4e79
    .word 0xffcd614e
    .word 0xffd38850
    .word 0x003bcb51
    .word 0xffca7be4
    .word 0x0027b19d
    .word 0xffcf384e
    .word 0x003d1b17
    .word 0x00309cbd
    .word 0x00333c71
    .word 0x0021fa3d
    .word 0x002fa10d
    .word 0xffd143e0
    .word 0xffd331f2
    .word 0xffd293cc
    .word 0x0032afc9
    .word 0xffcecb3e
    .word 0x002fa539
    .word 0xffdab9cc
    .word 0x002e1783
    .word 0x003ef769
    .word 0xffd2bee6
    .word 0xffdee6ae
    .word 0x00200f2f
    .word 0x00311a25
    .word 0x0021964b
    .word 0x0022efc1
    .word 0xffdc8d12
    .word 0x002e7fcf
    .word 0x003fbc19
    .word 0xffd0826e
    .word 0xffd15ad2
    .word 0x002defe5
    .word 0xffcffee4
    .word 0xffd1b976
    .word 0x00373527
    .word 0x003cb3ef
    .word 0xffc9b30c
    .word 0xffd27c3e
    .word 0x0034c0f1
    .word 0xffc2ed0c
    .word 0x0024e283
    .word 0x0027904f
    .word 0x0033c7c3
    .word 0x0035f411
    .word 0xffcb77d2
    .word 0x0032cd39
    .word 0xffc57d5e
    .word 0xffd0b480
    .word 0xffc6303c
    .word 0xffc13c62
    .word 0x002de671
    .word 0x003b73a9
    .word 0x0036f3d7
    .word 0xffc397ec
    .word 0x002172c3
    .word 0xffc2cfe6
    .word 0xffc77e10
    .word 0xffc13c32
    .word 0x003f5ef7
    .word 0xffd6e54e
    .word 0xffca975a
    .word 0xffdb82b0
    .word 0x00330353
    .word 0xffc29ace
    .word 0x00261ca5
    .word 0x002b2a1f
    .word 0xffdd7aba
    .word 0x0026329f
    .word 0xffd96280
    .word 0xffdcf590
    .word 0x0029d743
    .word 0x003ec25f
    .word 0xffc468e4
    .word 0x00380391
    .word 0x003a718b
    .word 0xffc8e97e
    .word 0xffd1b514
    .word 0xffc83db4
    .word 0xffd95bea
    .word 0xffcce908
    .word 0x0023adad
    .word 0xffc6fb98
    .word 0x00203777
    .word 0xffd27798
    .word 0x002d0a21
    .word 0xffd3cff2
    .word 0x0039f4d7
    .word 0xffd9a3ba
    .word 0xffc75184
    .word 0xffc68600
    .word 0x003a5547
    .word 0xffd4e526
    .word 0xffd48110
    .word 0x002d8acf
    .word 0xffd9d5de
    .word 0xffc80c8a
    .word 0xffd118f4
    .word 0x00296075
    .word 0x002ff303
    .word 0xffc2f95e
    .word 0xffd315da
    .word 0xffcb913a
    .word 0xffd4dd2a
    .word 0xffd72a52
    .word 0xffc30a22
    .word 0xffc4b9f6
    .word 0x0032c23d
    .word 0xffdd584a
    .word 0x00313e19
    .word 0x002bb69d
    .word 0xffc8ecc4
    .word 0xffc2e218
    .word 0x00255c6d
    .word 0x00334325
    .word 0xffd2ba3a
    .word 0xffcdf9c2
    .word 0x0033069d
    .word 0x0037713b
    .word 0x0029c42d
    .word 0xffcd1834
    .word 0xffcb2f44
    .word 0xffddaade
    .word 0x002ca86b
    .word 0xffd41056
    .word 0xffcca5c6
    .word 0x0027ad05
    .word 0xffd62f22
    .word 0xffce3c60
    .word 0x003a1df1
    .word 0x0021acc9
    .word 0x003235ad
    .word 0xffddaab4
    .word 0x002d7633
    .word 0x00323195
    .word 0x003f73f1
    .word 0x003d3efb
    .word 0xffc6491a
    .word 0x0032f56f
    .word 0xffd378d0
    .word 0xffd52c18
    .word 0xffc39d36
    .word 0xffd9ed16
    .word 0xffc22fd6
    .word 0x003204df
    .word 0xffc75ddc
    .word 0xffc54ac6
    .word 0x003bd10b
    .word 0xffcafcaa
    .word 0x00327915
    .word 0xffdedc94
    .word 0x002badff
    .word 0xffc21b12
    .word 0xffd5a532
    .word 0x0034656d
    .word 0x0038b213
    .word 0xffdc4624
    .word 0xffc6c5e0
    .word 0xffd4fa76
    .word 0xffdf08ea
    .word 0x003d70af
    .word 0xffcfacec
    .word 0x002b25eb
    .word 0xffd35062
    .word 0xffcd89ee
    .word 0x002b1855
    .word 0xffdb5ffe
    .word 0xffc4554e
    .word 0x0036938f
    .word 0xffcc8412
    .word 0xffc8e8cc
    .word 0xffc07a7a
    .word 0xffda6da4
    .word 0x003a5797
    .word 0x003a4851
    .word 0xffd50b4c
    .word 0x0031d97f
/* Second input */
input2:
    .word 0xffdefd11
    .word 0xffd096db
    .word 0xffdf8e7f
    .word 0xffd13a8b
    .word 0xffd04f4d
    .word 0xffd7268d
    .word 0x0039e896
    .word 0xffdeee2b
    .word 0xffd05939
    .word 0x00226752
    .word 0xffc18df3
    .word 0x0037d384
    .word 0x002b869c
    .word 0x002d6be2
    .word 0x00246824
    .word 0x002b54d4
    .word 0x002d72fe
    .word 0x003a6d8a
    .word 0xffd7a311
    .word 0x00258ee6
    .word 0xffd654f7
    .word 0x002b9250
    .word 0x002e9728
    .word 0xffc4827b
    .word 0x0027a100
    .word 0x002e0998
    .word 0xffd40603
    .word 0x00329f60
    .word 0x0027827a
    .word 0x0026350e
    .word 0x003d1358
    .word 0xffcede43
    .word 0xffc75353
    .word 0x0027a792
    .word 0x00354d86
    .word 0x002e6380
    .word 0x002f0206
    .word 0xffcb22cf
    .word 0x002a5bd8
    .word 0x003007b4
    .word 0xffc514e7
    .word 0xffc0ff89
    .word 0x002798c2
    .word 0xffdf03ef
    .word 0xffd664dd
    .word 0x003361e6
    .word 0xffddb9e5
    .word 0xffc27467
    .word 0xffdd70dd
    .word 0x002c4528
    .word 0xffc1c5ef
    .word 0xffc2d103
    .word 0xffdb3df9
    .word 0xffc13095
    .word 0x0038b58c
    .word 0xffd1e6d1
    .word 0xffc09bf5
    .word 0xffd9ebef
    .word 0xffd4df9b
    .word 0xffc0f9c7
    .word 0x002e3a6a
    .word 0xffca3ef9
    .word 0xffdb7057
    .word 0xffcf54f3
    .word 0x003ba51e
    .word 0x0028837c
    .word 0xffd65959
    .word 0x00351a2c
    .word 0xffc1dabd
    .word 0x00258bee
    .word 0x00259a86
    .word 0x0038b32e
    .word 0xffd58881
    .word 0x00272044
    .word 0x0031676a
    .word 0x00215dc4
    .word 0x003cab9e
    .word 0x0027bb90
    .word 0xffd7a79b
    .word 0xffd313f1
    .word 0x0025083c
    .word 0x003d6db8
    .word 0x002fd544
    .word 0x003c8f5c
    .word 0x003787f0
    .word 0xffc04751
    .word 0x0028a9b4
    .word 0x002f696a
    .word 0x002ff704
    .word 0xffdab599
    .word 0x00358bd2
    .word 0x003cb452
    .word 0x00245026
    .word 0x00314a44
    .word 0xffd4db1b
    .word 0x002c6106
    .word 0xffc99339
    .word 0x0031d908
    .word 0x00232026
    .word 0xffc0dd23
    .word 0x003a7fb6
    .word 0x003bdf88
    .word 0xffd1ff2b
    .word 0x00220bfe
    .word 0xffd4d7c5
    .word 0x0024d548
    .word 0x00336e8e
    .word 0xffc55c5d
    .word 0x00398db6
    .word 0x00246d24
    .word 0xffc47233
    .word 0x0038c188
    .word 0xffc281b5
    .word 0x002af3bc
    .word 0xffd7bd47
    .word 0x00393546
    .word 0xffd15e0d
    .word 0x002a7a0c
    .word 0x00309916
    .word 0x0030b79a
    .word 0x0037a324
    .word 0xffd5b17b
    .word 0xffdefa7d
    .word 0xffd9c5d3
    .word 0x003ceb0c
    .word 0x00326102
    .word 0xffcbebe9
    .word 0x0020c400
    .word 0xffdc4ea7
    .word 0xffd68cdf
    .word 0x003b3526
    .word 0x0027dba8
    .word 0xffd6c5f7
    .word 0x0022d178
    .word 0xffcceb5d
    .word 0xffce6951
    .word 0x003f724a
    .word 0x0023591a
    .word 0x003a1a84
    .word 0x00252c4a
    .word 0xffd0c1bf
    .word 0xffd47ad1
    .word 0xffd335b7
    .word 0xffc6da21
    .word 0x003f8422
    .word 0x0025cf66
    .word 0x0032e55a
    .word 0x002d9fe8
    .word 0xffc07873
    .word 0xffca2197
    .word 0xffc3a153
    .word 0xffd130e1
    .word 0xffc83b97
    .word 0xffc9c89f
    .word 0x0030aff2
    .word 0x002d8534
    .word 0x00353816
    .word 0xffce412f
    .word 0xffd785d5
    .word 0x002ba08e
    .word 0xffcbf56f
    .word 0x00340970
    .word 0xffd95303
    .word 0x00337b42
    .word 0x003bf76a
    .word 0xffc42601
    .word 0xffcb28a9
    .word 0x002236da
    .word 0xffd27a8b
    .word 0xffdd2ebb
    .word 0xffde4365
    .word 0x00281e7c
    .word 0xffd1694b
    .word 0x00384500
    .word 0x00341778
    .word 0xffd6fde3
    .word 0xffc9c9ff
    .word 0x00302d4e
    .word 0x003035ae
    .word 0xffd79869
    .word 0x002e19f6
    .word 0xffd51a39
    .word 0x003737de
    .word 0x002f696e
    .word 0xffd1bc19
    .word 0x002f3ba6
    .word 0xffd0ac91
    .word 0xffc9f67b
    .word 0x003700fe
    .word 0x00399a96
    .word 0xffd31023
    .word 0xffc6a353
    .word 0x003ed708
    .word 0xffc046ad
    .word 0x0037079c
    .word 0xffddef85
    .word 0x003b14f8
    .word 0xffc543bf
    .word 0x00207dac
    .word 0x002a743c
    .word 0x002a469e
    .word 0xffc8564d
    .word 0xffcc805f
    .word 0x002900c8
    .word 0x0025eeb4
    .word 0xffdaa367
    .word 0xffdcfa0d
    .word 0xffc6bba1
    .word 0x003de98c
    .word 0x0027013a
    .word 0xffc831ad
    .word 0x003e67c4
    .word 0xffd9e55f
    .word 0xffcdbb0b
    .word 0xffd1f927
    .word 0xffc0d5f1
    .word 0x003bcbb2
    .word 0xffdf8489
    .word 0xffd996bb
    .word 0xffc4e551
    .word 0x0032582e
    .word 0xffcf4d11
    .word 0x0039e1fe
    .word 0xffc794f9
    .word 0x003e8548
    .word 0xffd593b1
    .word 0xffde819f
    .word 0x00361f2e
    .word 0xffde6d45
    .word 0x00320df2
    .word 0xffc4850b
    .word 0x002cac74
    .word 0xffcccb4f
    .word 0xffda8ba5
    .word 0xffdafbd5
    .word 0xffcca333
    .word 0x003ba1d8
    .word 0x002539c2
    .word 0xffc8e5e9
    .word 0xffcedb5f
    .word 0x0039be68
    .word 0xffdd3569
    .word 0xffd1f9b9
    .word 0xffc3d79b
    .word 0xffde1f4b
    .word 0xffc276cd
    .word 0xffd1cca9
    .word 0x002f08dc
    .word 0x002e6ba2
    .word 0xffd1e3d5
    .word 0xffccb2a7
    .word 0x002b4a36
    .word 0x002d85f6
    .word 0xffc5a20b
    .word 0xffc17355
    .word 0xffcf9f05
/* Output placeholder */
output:
    .word 0x00000000
    .word 0x00000001
    .word 0x00000010
    .word 0x00000051
    .word 0x00000100
    .word 0x00000271
    .word 0x00000510
    .word 0x00000961
    .word 0x00001000
    .word 0x000019a1
    .word 0x00002710
    .word 0x00003931
    .word 0x00005100
    .word 0x00006f91
    .word 0x00009610
    .word 0x0000c5c1
    .word 0x00010000
    .word 0x00014641
    .word 0x00019a10
    .word 0x0001fd11
    .word 0x00027100
    .word 0x0002f7b1
    .word 0x00039310
    .word 0x00044521
    .word 0x00051000
    .word 0x0005f5e1
    .word 0x0006f910
    .word 0x00081bf1
    .word 0x00096100
    .word 0x000acad1
    .word 0x000c5c10
    .word 0x000e1781
    .word 0x00100000
    .word 0x00121881
    .word 0x00146410
    .word 0x0016e5d1
    .word 0x0019a100
    .word 0x001c98f1
    .word 0x001fd110
    .word 0x00234ce1
    .word 0x00271000
    .word 0x002b1e21
    .word 0x002f7b10
    .word 0x00342ab1
    .word 0x00393100
    .word 0x003e9211
    .word 0x00445210
    .word 0x004a7541
    .word 0x00510000
    .word 0x0057f6c1
    .word 0x005f5e10
    .word 0x00673a91
    .word 0x006f9100
    .word 0x00786631
    .word 0x0001df0f
    .word 0x000bc0a0
    .word 0x00162fff
    .word 0x00213260
    .word 0x002ccd0f
    .word 0x00390570
    .word 0x0045e0ff
    .word 0x00536550
    .word 0x0061980f
    .word 0x00707f00
    .word 0x00003ffe
    .word 0x0010a0ff
    .word 0x0021c80e
    .word 0x0033bb4f
    .word 0x004680fe
    .word 0x005a1f6f
    .word 0x006e9d0e
    .word 0x0004205e
    .word 0x001a6ffd
    .word 0x0031b29e
    .word 0x0049ef0d
    .word 0x00632c2e
    .word 0x007d70fd
    .word 0x0018e48d
    .word 0x00354e0c
    .word 0x0052d4bd
    .word 0x00717ffc
    .word 0x0011773c
    .word 0x0032820b
    .word 0x0054c80c
    .word 0x007850fb
    .word 0x001d44ab
    .word 0x00436b0a
    .word 0x006aec1b
    .word 0x0013eff9
    .word 0x003e3eda
    .word 0x006a0109
    .word 0x00175ee9
    .word 0x004620f8
    .word 0x00766fc9
    .word 0x00287407
    .word 0x005bf678
    .word 0x00113ff6
    .word 0x00481977
    .word 0x0000cc05
    .word 0x003b20c6
    .word 0x007740f5
    .word 0x003555e5
    .word 0x00752904
    .word 0x003703d4
    .word 0x007aaff3
    .word 0x00407713
    .word 0x00084301
    .word 0x0051fda2
    .word 0x001df0f0
    .word 0x006be701
    .word 0x003c29ff
    .word 0x000ea42f
    .word 0x00633fee
    .word 0x003a47ae
    .word 0x0013a5fc
    .word 0x006f457d
    .word 0x004d70eb
    .word 0x002e131b
    .word 0x001136f9
    .word 0x0076c78a
    .word 0x005f0fe8
    .word 0x0049fb48
    .word 0x003794f6
    .word 0x0027e856
    .word 0x001b00e4
    .word 0x0010ea34
    .word 0x0009aff2
    .word 0x00055de2
    .word 0x0003ffe0
    .word 0x0005a1e0
    .word 0x000a4fee
    .word 0x0012162e
    .word 0x001d00dc
    .word 0x002b1c4c
    .word 0x003c74ea
    .word 0x0051173a
    .word 0x00690fd8
    .word 0x00048b77
    .word 0x002356e5
    .word 0x00459f05
    .word 0x006b70d3
    .word 0x0014f962
    .word 0x004205e0
    .word 0x0072c390
    .word 0x00275fcd
    .word 0x005fa80d
    .word 0x001be9da
    .word 0x005bf2da
    .word 0x002010c7
    .word 0x00681177
    .word 0x003442d4
    .word 0x000492e3
    .word 0x0058efc1
    .word 0x0031a7a0
    .word 0x000ea8cd
    .word 0x006fe1ad
    .word 0x0055a0ba
    .word 0x003fd489
    .word 0x002e8bc6
    .word 0x0021d535
    .word 0x0019bfb2
    .word 0x00165a31
    .word 0x0017b3be
    .word 0x001ddb7d
    .word 0x0028e0aa
    .word 0x0038d299
    .word 0x004dc0b6
    .word 0x0067ba85
    .word 0x0006efa1
    .word 0x002b2fc0
    .word 0x0054aaad
    .word 0x0003904b
    .word 0x0037b098
    .word 0x00713ba7
    .word 0x003061a3
    .word 0x0074f2d2
    .word 0x003f3f8e
    .word 0x000f384c
    .word 0x0064cd99
    .word 0x00405017
    .word 0x0021b083
    .word 0x0008ffb1
    .word 0x00762e8e
    .word 0x00698e1c
    .word 0x00630f78
    .word 0x0062c3d6
    .word 0x0068bc82
    .word 0x00750ae0
    .word 0x0007e06b
    .word 0x00210eb9
    .word 0x0040c775
    .word 0x00671c63
    .word 0x00143f5e
    .word 0x0048025c
    .word 0x0002b767
    .word 0x004430a5
    .word 0x000cc050
    .word 0x005c38be
    .word 0x0032ec59
    .word 0x0010cda6
    .word 0x0075cf42
    .word 0x006243df
    .word 0x00561e4a
    .word 0x00517167
    .word 0x00545032
    .word 0x005ecdbf
    .word 0x0070fd3a
    .word 0x000b11e6
    .word 0x002cdf21
    .word 0x0056985e
    .word 0x00087128
    .word 0x00423d25
    .word 0x0004500f
    .word 0x004e7dbc
    .word 0x00211a16
    .word 0x007bf923
    .word 0x005f6efd
    .word 0x004b6fd9
    .word 0x00401003
    .word 0x003d63df
    .word 0x00437fe9
    .word 0x005278b5
    .word 0x006a62ef
    .word 0x000b735a
    .word 0x00357ed4
    .word 0x0068ba50
    .word 0x00255ad9
    .word 0x006b3595
    .word 0x003a9fbe
    .word 0x00138ea9
    .word 0x0075f7c3
    .word 0x0062308e
    .word 0x00582ea7
    .word 0x005807c2
    .word 0x0061d1ab
    .word 0x0075a246
    .word 0x0013af8e
    .word 0x003bcf99
    .word 0x006e3892
    .word 0x002b20bc
    .word 0x00725e75
    .word 0x0044482f
    .word 0x0020d477
    .word 0x000819f1
    .word 0x007a0f5a
    .word 0x00770b84
    .word 0x007f055c
    .word 0x001233e5
    .word 0x00306e3d
    .word 0x0059eb97
    .word 0x000ee33e
    .word 0x004f2c98
    .word 0x001b1f1f
    .word 0x00729269
    .word 0x0055de20
    .word 0x0044fa09